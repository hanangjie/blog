<html>

<head>
  <title>手机编辑器</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <script>
    
        window.onerror=function(e,a,b,c,d){
          alert(e)
          alert(a)
          alert(b)
        }</script>
<script src="../libs/ace.js" type="text/javascript" charset="utf-8"></script>
<script src="../libs/theme-twilight.js"></script>
<script src="../libs/mode-html.js"></script>

</head>
<style>
  body{
    display: flex;
    flex-direction: column;
  }
  #editor,
  #show {
    width: 100%;
    flex:1;
  }

  #show {
    background: #fff;
  }
  .btn{
    width: 100%;
    height: 30px;
  }
</style>

<body>
  
<iframe src="" id="show" frameborder="0" ></iframe>
<input type="button" class='btn' value="运行1" onclick="run()">
  <div id="editor">

  </div>
  <script>
    
    var editor = ace.edit("editor");
    var JavaScriptMode = ace.require("ace/mode/html").Mode;
    editor.session.setMode(new JavaScriptMode());
    editor.setTheme("ace/theme/twilight");

    editor.setValue('');
    
    function run() {
      var iframe = document.getElementById("show");
      iframe.contentWindow.document.open();
      iframe.contentWindow.document.write("<div id='log'></div><script>window.onerror=function(e){document.getElementById('log').innerHTML=document.getElementById('log').innerHTML+'<br>'+e;};"+
        "function log(str){document.getElementById('log').innerHTML=document.getElementById('log').innerHTML+'<br>'+str;};"+
      editor.getValue()+"<\/script>");
      iframe.contentWindow.document.close();
    }
  </script>
</body>

</html>